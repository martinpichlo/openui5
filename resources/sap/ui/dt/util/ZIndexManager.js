/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Popup","sap/ui/core/BusyIndicator","sap/base/Log","sap/ui/dt/Util","sap/m/InstanceManager","sap/base/util/includes"],function(P,B,L,U,I,i){"use strict";var Z=10;var a=3;var A=[];var _=[];function g(){return I.getOpenDialogs().concat(I.getOpenPopovers(),B.oPopup&&B.oPopup.isOpen()?[B.oPopup]:[]);}function b(C,m,e){if(++C<=m){if(i(e,C)){return b(C,m,e);}return C;}L.error('sap.ui.dt.util.ZIndexManager: z-index limit has been exceeded, therefore all following calls receive the same z-Index = '+m);return m;}function c(p){return p.map(function(o){return o._iZIndex||o.oPopup._iZIndex;});}var d={getNextZIndex:function(){var e=g();var v=[];var f=[];e.forEach(function(o){var V=_.every(function(F){return F(o);});V&&_.length>0?v.push(o):f.push(o);});var m=v.length>0?Math.max.apply(null,c(v)):-1;var M=f.length>0?Math.min.apply(null,c(f)):-1;if(m<M){return this._getNextMinZIndex(M);}return P.getNextZIndex();},getZIndexBelowPopups:function(){var o=g();var l;if(o.length>0){l=Math.min.apply(null,c(o));}if(!U.isInteger(l)){return P.getNextZIndex();}return this._getNextMinZIndex(l);},addPopupFilter:function(f){if(typeof f==="function"){_=_.concat([f]);}},removePopupFilter:function(f){_=_.filter(function(e){return e===f;});},_getNextMinZIndex:function(C){var m=C-a;var M=C-Z;var n=b(M,m,A);A.push(n);return n;}};return d;});
